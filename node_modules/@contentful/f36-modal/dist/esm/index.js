import * as P from 'react';
import P__default from 'react';
import uo from 'react-modal';
import { Flex, Box } from '@contentful/f36-core';
import { cx, css } from 'emotion';
import { CloseIcon } from '@contentful/f36-icons';
import { Button, ButtonGroup } from '@contentful/f36-button';
import { Subheading } from '@contentful/f36-typography';
import m from '@contentful/f36-tokens';
import X from 'react-dom';

var to=Object.defineProperty,no=Object.defineProperties;var ro=Object.getOwnPropertyDescriptors;var E=Object.getOwnPropertySymbols;var G=Object.prototype.hasOwnProperty,Y=Object.prototype.propertyIsEnumerable;var q=(o,e,t)=>e in o?to(o,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):o[e]=t,l=(o,e)=>{for(var t in e||(e={}))G.call(e,t)&&q(o,t,e[t]);if(E)for(var t of E(e))Y.call(e,t)&&q(o,t,e[t]);return o},u=(o,e)=>no(o,ro(e));var h=(o,e)=>{var t={};for(var n in o)G.call(o,n)&&e.indexOf(n)<0&&(t[n]=o[n]);if(o!=null&&E)for(var n of E(o))e.indexOf(n)<0&&Y.call(o,n)&&(t[n]=o[n]);return t};var F=(o,e,t)=>new Promise((n,i)=>{var a=r=>{try{d(t.next(r));}catch(M){i(M);}},s=r=>{try{d(t.throw(r));}catch(M){i(M);}},d=r=>r.done?n(r.value):Promise.resolve(r.value).then(a,s);d((t=t.apply(o,e)).next());});function K(){return {root:css({position:"relative",padding:`${m.spacingM} ${m.spacingM} ${m.spacingM} ${m.spacingL}`,borderRadius:`${m.borderRadiusMedium} ${m.borderRadiusMedium} 0 0`,borderBottom:`1px solid ${m.gray300}`}),buttonContainer:css({position:"relative",width:m.spacing2Xl,height:m.spacingL,button:{position:"absolute",top:`calc(-1 * ${m.spacing2Xs})`,right:0}})}}var v=a=>{var s=a,{onClose:o,title:e,testId:t="cf-ui-modal-header",className:n}=s,i=h(s,["onClose","title","testId","className"]);let d=K();return P__default.createElement(Flex,u(l({},i),{className:cx(d.root,n),testId:t,alignItems:"center",justifyContent:"space-between"}),P__default.createElement(Subheading,{as:"h2",isTruncated:!0,marginBottom:"none"},e),o&&P__default.createElement(Flex,{alignItems:"center",className:d.buttonContainer},P__default.createElement(Button,{variant:"transparent","aria-label":"Close",startIcon:P__default.createElement(CloseIcon,{size:"small"}),onClick:()=>{o();},size:"small"})))};v.displayName="ModalHeader";function U(){return {root:css({padding:`${m.spacingM} ${m.spacingL}`,color:m.gray700,fontSize:m.fontSizeM,fontFamily:m.fontStackPrimary,lineHeight:m.lineHeightM,overflowY:"auto",overflowX:"auto",boxSizing:"border-box"})}}var R=i=>{var a=i,{testId:o="cf-ui-modal-content",className:e,children:t}=a,n=h(a,["testId","className","children"]);let s=U();return P__default.createElement(Box,u(l({},n),{as:"div",className:cx(s.root,e),testId:o}),t)};R.displayName="ModalContent";function V(o){let e=cx(css({margin:m.spacing2Xl,backgroundColor:m.colorWhite,borderRadius:o.size==="zen"?0:m.borderRadiusMedium,boxShadow:m.boxShadowHeavy,maxHeight:`calc(100vh - 1rem * (100 / ${m.fontBaseDefault}))`,maxWidth:`calc(100vw - 1rem * (100 / ${m.fontBaseDefault}))`,overflow:"hidden",display:"flex",flexDirection:"column"}),o.allowHeightOverflow?css({overflow:"auto",maxHeight:"none"}):null,o.size==="zen"?css({maxWidth:"none",maxHeight:"none",margin:0,height:"100%",width:"100%"}):null,o.className);return {portal:css({display:"block"}),base:{root:cx(css({zIndex:m.zIndexModalContent,position:"relative",padding:0,display:"inline-block",margin:"0 auto",textAlign:"left",outline:"none",transform:o.size==="zen"?"scale(1)":"scale(0.85)",transition:`transform ${m.transitionDurationDefault} ${m.transitionEasingDefault}`}),o.size==="zen"?css({width:"100%",height:"100%"}):null),afterOpen:css({transform:"scale(1) !important"}),beforeClose:css({transform:o.size==="zen"?"scale(1)":"scale(0.85)"})},modalOverlay:{root:cx(css({display:"flex",alignItems:"baseline",flexWrap:"wrap",top:0,right:0,bottom:0,left:0,zIndex:m.zIndexModal,opacity:0,transition:`opacity ${m.transitionDurationDefault} ${m.transitionEasingDefault}`,position:"fixed",overflowY:"auto",backgroundColor:"rgba(12, 20, 28, 0.74902)",textAlign:"center"}),o.position==="center"?css({alignItems:"center",justifyContent:"center"}):null,o.overlayClassName),afterOpen:css({opacity:1}),beforeClose:css({opacity:0})},modal:e}}var Co={medium:"520px",small:"400px",large:"700px",fullWidth:"100vw",zen:"100vw"};function yo(o){if(o&&o.querySelectorAll){let e=o.querySelectorAll("input, button");if(e.length>0){let t=e[0];typeof t.focus=="function"&&t.focus();}}}var j=M=>{var S=M,{allowHeightOverflow:o=!1,position:e="center",shouldCloseOnEscapePress:t=!0,shouldCloseOnOverlayClick:n=!0,size:i="medium",testId:a="cf-ui-modal",topOffset:s="50px",aria:d}=S,r=h(S,["allowHeightOverflow","position","shouldCloseOnEscapePress","shouldCloseOnOverlayClick","size","testId","topOffset","aria"]);var I,L;let z=P.useRef(null),x=u(l({},r),{allowHeightOverflow:o,position:e,shouldCloseOnEscapePress:t,shouldCloseOnOverlayClick:n,size:i,testId:a,topOffset:s}),c=V({position:e,size:i,allowHeightOverflow:o,className:r.className,overlayClassName:(I=r.overlayProps)==null?void 0:I.className}),B=()=>{var O,N;let f=z.current;if(f){let T=document.activeElement;if(f!==T&&f.contains(T))return}let b=(O=x.initialFocusRef)==null?void 0:O.current;b?(N=b.focus)==null||N.call(b):f&&yo(f);},$=(...f)=>{x.onAfterOpen&&x.onAfterOpen(...f),B();},k=()=>P.createElement(P.Fragment,null,r.title&&P.createElement(v,l({title:r.title,onClose:x.onClose},r.modalHeaderProps)),P.createElement(R,l({},r.modalContentProps),r.children));return P.createElement(uo,{ariaHideApp:!1,aria:d,onRequestClose:x.onClose,isOpen:r.isShown,onAfterOpen:$,shouldCloseOnEsc:t,shouldCloseOnOverlayClick:n,shouldFocusAfterRender:!0,shouldReturnFocusAfterClose:!0,portalClassName:c.portal,style:{content:{top:e==="center"?0:s},overlay:(L=r.overlayProps)==null?void 0:L.style},className:{base:c.base.root,afterOpen:c.base.afterOpen,beforeClose:c.base.beforeClose},overlayClassName:{base:c.modalOverlay.root,afterOpen:c.modalOverlay.afterOpen,beforeClose:c.modalOverlay.beforeClose},closeTimeoutMS:200,contentRef:f=>{z.current=f;}},P.createElement(Box,{testId:a,style:{width:Co[i]||i},className:c.modal,"data-modal-root":!0},typeof r.children=="function"?r.children(x):k()))};j.displayName="Modal";var A=i=>{var a=i,{testId:o="cf-ui-modal-controls",className:e,children:t}=a,n=h(a,["testId","className","children"]);return P__default.createElement(Flex,u(l({},n),{className:e,testId:o,flexDirection:"row",justifyContent:"flex-end",margin:"spacingL",marginTop:"none"}),P__default.createElement(ButtonGroup,{variant:"spaced",spacing:"spacingS"},t))};A.displayName="ModalControls";var g=j;g.Content=R;g.Header=v;g.Controls=A;var oo=({allowHeightOverflow:o=!1,cancelLabel:e="Cancel",cancelTestId:t="cf-ui-modal-confirm-cancel-button",children:n,confirmLabel:i="Confirm",confirmTestId:a="cf-ui-modal-confirm-confirm-button",intent:s="positive",isConfirmDisabled:d=!1,isConfirmLoading:r=!1,isShown:M,modalContentProps:S,modalControlsProps:z,modalHeaderProps:x,onCancel:c,onConfirm:B,shouldCloseOnEscapePress:$=!0,shouldCloseOnOverlayClick:k=!0,size:I="medium",testId:L="cf-ui-modal-confirm",title:f="Are you sure?",initialFocusRef:b})=>{let O=P__default.useRef(null),N=i?P__default.createElement(Button,{testId:a,isDisabled:d,isLoading:r,variant:s,size:"small",onClick:()=>B()},i):null,T=e?P__default.createElement(Button,{testId:t,variant:"secondary",onClick:c,size:"small",ref:b||O},e):null;return P__default.createElement(g,{testId:L,isShown:M,onClose:c,size:I,shouldCloseOnOverlayClick:k,shouldCloseOnEscapePress:$,allowHeightOverflow:o,initialFocusRef:O},()=>P__default.createElement(P__default.Fragment,null,P__default.createElement(g.Header,l({title:f||""},x)),P__default.createElement(g.Content,l({},S),n),P__default.createElement(g.Controls,l({},z),T,N)))};oo.displayName="ModalConfirm";var eo=o=>{let e=document.getElementById(o);return e!==null||(e=document.createElement("div"),e.setAttribute("id",o),document.body.appendChild(e)),e},D=new Map;function xo(){D.forEach((i,a)=>F(this,[i,a],function*({render:o,currentConfig:e,delay:t},n){let s=u(l({},e),{isShown:!1});o(s),yield new Promise(d=>setTimeout(d,t)),X.unmountComponentAtNode(eo(n)),D.delete(n);}));}function ho(o,e={}){e=l({delay:300},e);let t=`modals-root${e.modalId||Date.now()}`,n=eo(t);return new Promise(i=>{let a={onClose:d,isShown:!0};function s({onClose:r,isShown:M}){X.render(o({onClose:r,isShown:M}),n);}function d(r){return F(this,null,function*(){a=u(l({},a),{isShown:!1}),s(a),yield new Promise(M=>setTimeout(M,e.delay)),X.unmountComponentAtNode(n),n.remove(),D.delete(t),i(r);})}s(a),D.set(t,{render:s,currentConfig:a,delay:e.delay});})}var bo={open:ho,closeAll:xo};

export { g as Modal, oo as ModalConfirm, R as ModalContent, A as ModalControls, v as ModalHeader, bo as ModalLauncher };
//# sourceMappingURL=index.js.map